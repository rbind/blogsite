<!DOCTYPE html>
<html>
  <head>
    <title>DFIRE_RNA</title>
    <meta charset="utf-8">
    <meta name="author" content="TC" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/default-fonts.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# DFIRE_RNA
### TC
### 2018/05/09

---







## PDB issue

- 3dRNAscore and rosetta are unhappy about unnatural nucleotides
- 3dRNAscore used script to discard them before scoring

&lt;img src="180502_dfire_files/figure-html/unnamed-chunk-1-1.png" style="display: block; margin: auto;" /&gt;

- old PDB/ new PDB formats

&gt; O4* -&gt; O4'

&gt; O1P -&gt; OP1

&gt; rC -&gt; C

---


## Training dataset

- PDB RNA structures only (without protein or DNA)
  - 79 -&gt; 55
  - cleaned up by cd-hit-est 
     - removed homologs &amp; homologs to the test set

  
- RNA in protein complexes (with protein)
  - 198
  - same as others


---

## Test dataset 

- randstr
   - 81 native PDB: 500 decoys each
   - decoys: close -&gt; distance, gradient

- farna
   - 20 native PDB: 500 near-native decoys each


- farfar
   - 25 native RNA motifs: 4~48 near-native decoys
   - Generated by Rosetta protocol

---

## Scores

- Scores compared:  
     - **3drnascore**: distance term + torsion angle term   
     - **rasp**: trained on the 85 native structures in decoyset 1  
     - **dfire_c**: dfire_rna trained on RNAs from complex structures (198)  
     - **dfire_v**: dfire_rna trained on RNAs from RNA-only structures (55)  
     - **rosetta**: rosetta rna_score
     
---

## decoy test

&lt;img src="180502_dfire_files/figure-html/unnamed-chunk-2-1.png" style="display: block; margin: auto;" /&gt;


---

## near native test (COR)



&lt;img src="180502_dfire_files/figure-html/unnamed-chunk-3-1.png" style="display: block; margin: auto;" /&gt;



```r
gg2$data
```

```
##     pdbid            type        CORR
## 1   1a9nR    CORR_DFIRE_c -0.74375645
## 2   1e7kD    CORR_DFIRE_c -0.89851121
## 3   1ec6D    CORR_DFIRE_c -0.89047078
## 4   1et4E    CORR_DFIRE_c -0.85918497
## 5   1i6uD    CORR_DFIRE_c -0.90002070
## 6   1jbrD    CORR_DFIRE_c -0.89531960
## 7   1kogP    CORR_DFIRE_c -0.86146379
## 8   1kuqB    CORR_DFIRE_c -0.93013405
## 9   1kxkA    CORR_DFIRE_c -0.87469783
## 10  1mjiD    CORR_DFIRE_c -0.85284774
## 11  1msyA    CORR_DFIRE_c -0.89264103
## 12  1mzpB    CORR_DFIRE_c -0.92433625
## 13  1ooaD    CORR_DFIRE_c -0.81981755
## 14  1q93C    CORR_DFIRE_c -0.88036731
## 15  1q96C    CORR_DFIRE_c -0.88384502
## 16  1qa6D    CORR_DFIRE_c -0.87490229
## 17  1s03B    CORR_DFIRE_c -0.90190677
## 18  1u63D    CORR_DFIRE_c -0.91354879
## 19  1un6F    CORR_DFIRE_c -0.92165049
## 20  1urnQ    CORR_DFIRE_c -0.85676946
## 21  1xokA    CORR_DFIRE_c -0.59359575
## 22  1y26X    CORR_DFIRE_c -0.90098129
## 23  1zbhF    CORR_DFIRE_c -0.89053985
## 24  1zhoH    CORR_DFIRE_c -0.90716878
## 25  2bs1S    CORR_DFIRE_c -0.86537347
## 26  2dr2B    CORR_DFIRE_c -0.82147460
## 27  2drbB    CORR_DFIRE_c -0.90714725
## 28  2ipyD    CORR_DFIRE_c -0.87282313
## 29  2nueC    CORR_DFIRE_c -0.92086139
## 30  2nufD    CORR_DFIRE_c -0.86220758
## 31  2oiuQ    CORR_DFIRE_c -0.93160257
## 32  2ozbF    CORR_DFIRE_c -0.89514182
## 33  2pjpB    CORR_DFIRE_c -0.85460886
## 34  2pxvB    CORR_DFIRE_c -0.90641425
## 35  2quxR    CORR_DFIRE_c          NA
## 36  2qwyC    CORR_DFIRE_c -0.84075361
## 37  2uwmD    CORR_DFIRE_c -0.83628939
## 38  2w2hS    CORR_DFIRE_c -0.83947613
## 39  2zniD    CORR_DFIRE_c -0.92907849
## 40  361dB    CORR_DFIRE_c -0.71671665
## 41  387dA    CORR_DFIRE_c -0.57634901
## 42  3f1gZ    CORR_DFIRE_c -0.90461330
## 43  3gcaA    CORR_DFIRE_c -0.83860338
## 44  1a9nR    CORR_DFIRE_v -0.77743800
## 45  1e7kD    CORR_DFIRE_v -0.88909833
## 46  1ec6D    CORR_DFIRE_v -0.89796515
## 47  1et4E    CORR_DFIRE_v -0.87613383
## 48  1i6uD    CORR_DFIRE_v -0.90030889
## 49  1jbrD    CORR_DFIRE_v -0.90029371
## 50  1kogP    CORR_DFIRE_v -0.86774261
## 51  1kuqB    CORR_DFIRE_v -0.92915495
## 52  1kxkA    CORR_DFIRE_v -0.88496990
## 53  1mjiD    CORR_DFIRE_v -0.85694117
## 54  1msyA    CORR_DFIRE_v -0.89249473
## 55  1mzpB    CORR_DFIRE_v -0.91927204
## 56  1ooaD    CORR_DFIRE_v -0.84161715
## 57  1q93C    CORR_DFIRE_v -0.87475429
## 58  1q96C    CORR_DFIRE_v -0.88221368
## 59  1qa6D    CORR_DFIRE_v -0.87216809
## 60  1s03B    CORR_DFIRE_v -0.90508681
## 61  1u63D    CORR_DFIRE_v -0.91583269
## 62  1un6F    CORR_DFIRE_v -0.93000640
## 63  1urnQ    CORR_DFIRE_v -0.85875356
## 64  1xokA    CORR_DFIRE_v -0.70383849
## 65  1y26X    CORR_DFIRE_v -0.90579978
## 66  1zbhF    CORR_DFIRE_v -0.89522402
## 67  1zhoH    CORR_DFIRE_v -0.91533983
## 68  2bs1S    CORR_DFIRE_v -0.85791830
## 69  2dr2B    CORR_DFIRE_v -0.82935110
## 70  2drbB    CORR_DFIRE_v -0.90414226
## 71  2ipyD    CORR_DFIRE_v -0.91024389
## 72  2nueC    CORR_DFIRE_v -0.91760396
## 73  2nufD    CORR_DFIRE_v -0.86438457
## 74  2oiuQ    CORR_DFIRE_v -0.93318769
## 75  2ozbF    CORR_DFIRE_v -0.90747179
## 76  2pjpB    CORR_DFIRE_v -0.86231148
## 77  2pxvB    CORR_DFIRE_v -0.90780736
## 78  2quxR    CORR_DFIRE_v          NA
## 79  2qwyC    CORR_DFIRE_v -0.83890755
## 80  2uwmD    CORR_DFIRE_v -0.84233947
## 81  2w2hS    CORR_DFIRE_v -0.83720369
## 82  2zniD    CORR_DFIRE_v -0.92687017
## 83  361dB    CORR_DFIRE_v -0.69732461
## 84  387dA    CORR_DFIRE_v -0.57669774
## 85  3f1gZ    CORR_DFIRE_v -0.90320631
## 86  3gcaA    CORR_DFIRE_v -0.83802424
## 87  1a9nR       CORR_RASP -0.84561275
## 88  1e7kD       CORR_RASP -0.80164859
## 89  1ec6D       CORR_RASP -0.92890702
## 90  1et4E       CORR_RASP -0.91279584
## 91  1i6uD       CORR_RASP -0.93340244
## 92  1jbrD       CORR_RASP -0.94639037
## 93  1kogP       CORR_RASP -0.92660137
## 94  1kuqB       CORR_RASP -0.92713696
## 95  1kxkA       CORR_RASP -0.89786474
## 96  1mjiD       CORR_RASP -0.92147771
## 97  1msyA       CORR_RASP -0.93118588
## 98  1mzpB       CORR_RASP -0.93892071
## 99  1ooaD       CORR_RASP -0.80149283
## 100 1q93C       CORR_RASP -0.90732436
## 101 1q96C       CORR_RASP -0.91747582
## 102 1qa6D       CORR_RASP -0.90954905
## 103 1s03B       CORR_RASP -0.93555239
## 104 1u63D       CORR_RASP -0.89997541
## 105 1un6F       CORR_RASP -0.92770652
## 106 1urnQ       CORR_RASP -0.85831081
## 107 1xokA       CORR_RASP -0.84378971
## 108 1y26X       CORR_RASP -0.94696226
## 109 1zbhF       CORR_RASP -0.92199283
## 110 1zhoH       CORR_RASP -0.91158425
## 111 2bs1S       CORR_RASP -0.83854433
## 112 2dr2B       CORR_RASP -0.82388092
## 113 2drbB       CORR_RASP -0.91300803
## 114 2ipyD       CORR_RASP -0.94714003
## 115 2nueC       CORR_RASP -0.93279003
## 116 2nufD       CORR_RASP -0.94602671
## 117 2oiuQ       CORR_RASP -0.95266442
## 118 2ozbF       CORR_RASP -0.95347404
## 119 2pjpB       CORR_RASP -0.94508539
## 120 2pxvB       CORR_RASP -0.92473144
## 121 2quxR       CORR_RASP          NA
## 122 2qwyC       CORR_RASP -0.87164968
## 123 2uwmD       CORR_RASP -0.93828301
## 124 2w2hS       CORR_RASP -0.90750882
## 125 2zniD       CORR_RASP -0.92027767
## 126 361dB       CORR_RASP -0.89478406
## 127 387dA       CORR_RASP -0.57158841
## 128 3f1gZ       CORR_RASP -0.93403084
## 129 3gcaA       CORR_RASP -0.90283731
## 130 1a9nR CORR_3DRNASCORE -0.85618747
## 131 1e7kD CORR_3DRNASCORE -0.91564604
## 132 1ec6D CORR_3DRNASCORE -0.93176935
## 133 1et4E CORR_3DRNASCORE -0.88970308
## 134 1i6uD CORR_3DRNASCORE -0.89489408
## 135 1jbrD CORR_3DRNASCORE -0.94522106
## 136 1kogP CORR_3DRNASCORE -0.89522307
## 137 1kuqB CORR_3DRNASCORE -0.93922202
## 138 1kxkA CORR_3DRNASCORE -0.92544643
## 139 1mjiD CORR_3DRNASCORE -0.89007334
## 140 1msyA CORR_3DRNASCORE -0.91209320
## 141 1mzpB CORR_3DRNASCORE -0.91489956
## 142 1ooaD CORR_3DRNASCORE -0.85824082
## 143 1q93C CORR_3DRNASCORE -0.88299659
## 144 1q96C CORR_3DRNASCORE -0.89913437
## 145 1qa6D CORR_3DRNASCORE -0.87022878
## 146 1s03B CORR_3DRNASCORE -0.90027315
## 147 1u63D CORR_3DRNASCORE -0.91315160
## 148 1un6F CORR_3DRNASCORE -0.93832419
## 149 1urnQ CORR_3DRNASCORE -0.88253572
## 150 1xokA CORR_3DRNASCORE -0.85083129
## 151 1y26X CORR_3DRNASCORE -0.89723211
## 152 1zbhF CORR_3DRNASCORE -0.91656240
## 153 1zhoH CORR_3DRNASCORE -0.94404952
## 154 2bs1S CORR_3DRNASCORE -0.90012968
## 155 2dr2B CORR_3DRNASCORE -0.84745509
## 156 2drbB CORR_3DRNASCORE -0.92398075
## 157 2ipyD CORR_3DRNASCORE -0.95759199
## 158 2nueC CORR_3DRNASCORE -0.91774191
## 159 2nufD CORR_3DRNASCORE -0.91985299
## 160 2oiuQ CORR_3DRNASCORE -0.93804258
## 161 2ozbF CORR_3DRNASCORE -0.95210067
## 162 2pjpB CORR_3DRNASCORE -0.91726168
## 163 2pxvB CORR_3DRNASCORE -0.92139000
## 164 2quxR CORR_3DRNASCORE          NA
## 165 2qwyC CORR_3DRNASCORE -0.85348199
## 166 2uwmD CORR_3DRNASCORE -0.90439556
## 167 2w2hS CORR_3DRNASCORE -0.90535445
## 168 2zniD CORR_3DRNASCORE -0.91963173
## 169 361dB CORR_3DRNASCORE -0.91304639
## 170 387dA CORR_3DRNASCORE -0.59860051
## 171 3f1gZ CORR_3DRNASCORE -0.90906309
## 172 3gcaA CORR_3DRNASCORE -0.84781026
## 173 1a9nR    CORR_ROSETTA -0.62534119
## 174 1e7kD    CORR_ROSETTA -0.72211121
## 175 1ec6D    CORR_ROSETTA -0.73718260
## 176 1et4E    CORR_ROSETTA -0.76080150
## 177 1i6uD    CORR_ROSETTA -0.80740917
## 178 1jbrD    CORR_ROSETTA -0.75886748
## 179 1kogP    CORR_ROSETTA -0.74834676
## 180 1kuqB    CORR_ROSETTA -0.86264960
## 181 1kxkA    CORR_ROSETTA -0.82923508
## 182 1mjiD    CORR_ROSETTA -0.70357407
## 183 1msyA    CORR_ROSETTA -0.76559720
## 184 1mzpB    CORR_ROSETTA -0.82499444
## 185 1ooaD    CORR_ROSETTA -0.84722509
## 186 1q93C    CORR_ROSETTA -0.74809040
## 187 1q96C    CORR_ROSETTA -0.69898794
## 188 1qa6D    CORR_ROSETTA -0.72973945
## 189 1s03B    CORR_ROSETTA -0.81282851
## 190 1u63D    CORR_ROSETTA -0.75047520
## 191 1un6F    CORR_ROSETTA -0.88127145
## 192 1urnQ    CORR_ROSETTA -0.76478100
## 193 1xokA    CORR_ROSETTA -0.73957053
## 194 1y26X    CORR_ROSETTA -0.81382312
## 195 1zbhF    CORR_ROSETTA -0.77712296
## 196 1zhoH    CORR_ROSETTA -0.86910611
## 197 2bs1S    CORR_ROSETTA -0.60336891
## 198 2dr2B    CORR_ROSETTA -0.77271042
## 199 2drbB    CORR_ROSETTA -0.76654813
## 200 2ipyD    CORR_ROSETTA -0.88360730
## 201 2nueC    CORR_ROSETTA -0.77883940
## 202 2nufD    CORR_ROSETTA -0.73951990
## 203 2oiuQ    CORR_ROSETTA -0.84496899
## 204 2ozbF    CORR_ROSETTA -0.80812941
## 205 2pjpB    CORR_ROSETTA -0.78144612
## 206 2pxvB    CORR_ROSETTA -0.76462386
## 207 2quxR    CORR_ROSETTA          NA
## 208 2qwyC    CORR_ROSETTA -0.74891317
## 209 2uwmD    CORR_ROSETTA -0.64773447
## 210 2w2hS    CORR_ROSETTA -0.50335107
## 211 2zniD    CORR_ROSETTA -0.82579686
## 212 361dB    CORR_ROSETTA -0.08905075
## 213 387dA    CORR_ROSETTA -0.55965065
## 214 3f1gZ    CORR_ROSETTA -0.75385889
## 215 3gcaA    CORR_ROSETTA -0.66231258
```

---

## near native test (ES)

&lt;img src="180502_dfire_files/figure-html/unnamed-chunk-5-1.png" style="display: block; margin: auto;" /&gt;


---

## DFIRE complex / RNA-only

- complex structures: 198 vs RNA-only: 55
- Pearson correlation coefficient seems to

&lt;img src="180502_dfire_files/figure-html/unnamed-chunk-6-1.png" style="display: block; margin: auto;" /&gt;



---

## Ongoing

- Implementing torsion angle term
    </textarea>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function() {
  var d = document, s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})();</script>

<script>
(function() {
  var i, text, code, codes = document.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
})();
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
