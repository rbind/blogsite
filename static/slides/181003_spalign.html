<!DOCTYPE html>
<html>
  <head>
    <title>SPalign_RNA: SPalign for RNA Structures</title>
    <meta charset="utf-8">
    <meta name="author" content="TC" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/default-fonts.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# SPalign_RNA: SPalign for RNA Structures
### TC
### 2018-09-25 (updated: 2018-10-03)

---




class: center, middle, inverse

## SPalign_RNA

---

## Comparison with RMalign

- Random RNA pairs
- pair_num: number of pairwise alignment performed
- nali: number of alignment length (mean)
- rmsd: root mean square deviation (mean)

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; lenbin &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; pair_num &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; nali_sp &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; nali_rm &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; rmsd_sp &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; rmsd_rm &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; (10,15] &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4225 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 12.832 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 12.545 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.593 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.052 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; (15,20] &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3672 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 16.540 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 16.352 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.833 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.209 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; (20,25] &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3762 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 19.181 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 19.179 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.132 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.347 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; (25,30] &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1661 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 20.848 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 21.318 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.437 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.462 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; (30,80] &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2044 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 27.210 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 29.085 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.419 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.606 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; (80,Inf] &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 36 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 46.722 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 53.389 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.522 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.036 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;



---
## Nali &amp; RMSD

.pull-left[


&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="181003_spalign_files/figure-html/unnamed-chunk-2-1.png" alt="Nali, x:spalign, y:rmalign"  /&gt;
&lt;p class="caption"&gt;Nali, x:spalign, y:rmalign&lt;/p&gt;
&lt;/div&gt;


]

.pull-right[
&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="181003_spalign_files/figure-html/unnamed-chunk-3-1.png" alt="RMSD, x:spalign, y:rmalign"  /&gt;
&lt;p class="caption"&gt;RMSD, x:spalign, y:rmalign&lt;/p&gt;
&lt;/div&gt;

]

--
.foot-note[
RMSDs not ideal.
]

---

class: center, middle, inverse

## Alignment by map_align

---

## Method

- RNA contact map
    - RNA base distance &lt; 8.0A

- map_align
    - Using default parameters
    - Total score = overlapping contacts - gap penalty 
    
- Test: Scor binary classification test

---

## Result - Scor binary classification test




|                 |   mcc|   acc|   auc|    f1|
|:----------------|-----:|-----:|-----:|-----:|
|RMscore(average) | 0.724| 0.861| 0.933| 0.871|
|SPe              | 0.678| 0.819| 0.873| 0.815|
|mapaln_norm      | 0.454| 0.722| 0.796| 0.771|
|mapaln_unf       | 0.472| 0.665| 0.683| 0.574|



&lt;img src="181003_spalign_files/figure-html/unnamed-chunk-6-1.png" style="display: block; margin: auto;" /&gt;

---

## ROC

&lt;img src="181003_spalign_files/figure-html/unnamed-chunk-7-1.png" style="display: block; margin: auto;" /&gt;

---

## Score

&lt;img src="181003_spalign_files/figure-html/unnamed-chunk-8-1.png" style="display: block; margin: auto;" /&gt;

--
- Many false positives?


---

## Other Normalization

.pull-left[
- Unnormalized: `\(S_{Norm0}\)`
    - `\(S_{Norm1}=\frac{S}{min(N_{contact1},N_{contact1})}\)`
    - `\(S_{Norm2}=S_{Norm1}min(\frac{N_{contact}}{L})\)`
    - `\(S_{Norm3}=\frac{S}{min(L_1,L_2)}\)`
    - `\(S_{Norm3}=\frac{S}{min(L_1,L_2)^{0.7}}\)`
    - `\(S_{Norm4}=\frac{S}{min(L_1,L_2)^{0.3}}\)`
    - rm : rmalign score
    - spe : spalign score
]
.pull-right[

|      |   mcc|   acc|   auc|    f1|
|:-----|-----:|-----:|-----:|-----:|
|norm0 | 0.507| 0.691| 0.716| 0.619|
|norm1 | 0.465| 0.730| 0.804| 0.776|
|norm2 | 0.360| 0.649| 0.714| 0.705|
|norm3 | 0.451| 0.681| 0.759| 0.758|
|norm4 | 0.510| 0.692| 0.727| 0.620|
|norm5 | 0.531| 0.717| 0.757| 0.667|
|rm    | 0.751| 0.876| 0.942| 0.887|
|spe   | 0.700| 0.833| 0.889| 0.828|
]

---

## ROC curve

&lt;img src="181003_spalign_files/figure-html/unnamed-chunk-10-1.png" style="display: block; margin: auto;" /&gt;


---
## RNA Contact Map examples



&lt;img src="181003_spalign_files/figure-html/unnamed-chunk-12-1.png" style="display: block; margin: auto;" /&gt;


---



## Notes

.pull-left[
&lt;img src="181003_spalign_files/figure-html/unnamed-chunk-13-1.png" style="display: block; margin: auto;" /&gt;
]

.pull-right[
- Short RNAs 
    - low contacts 
    - Unable to generate meaningful contact-map align
- Longer RNAs (30~)
    - performance of map_align is still below spalign/mapalign
]
    </textarea>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function() {
  var d = document, s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})();</script>

<script>
(function() {
  var i, text, code, codes = document.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
})();
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
