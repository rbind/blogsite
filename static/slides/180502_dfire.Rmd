---
title: "DFIRE_RNA"
author: "TC"
date: "2018/05/09"
output:
  xaringan::moon_reader:
    css: ["default", "default-fonts"]
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---



```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE,echo=FALSE, message=FALSE)
library(data.table)
library(dplyr)
library(tidyr)
library(ggplot2)
```


## PDB issue

- 3dRNAscore and rosetta are unhappy about unnatural nucleotides
- 3dRNAscore used script to discard them before scoring

```{r fig.height=4,fig.align='center', echo=FALSE, warning=FALSE}
load("~/GIT/dfire_rna/dataset/decoy_test/gg_score.rda")

print(gg_score)
```

- old PDB/ new PDB formats

> O4* -> O4'

> O1P -> OP1

> rC -> C

---


## Training dataset

- PDB RNA structures only (without protein or DNA)
  - 79 -> 55
  - cleaned up by cd-hit-est 
     - removed homologs & homologs to the test set

  
- RNA in protein complexes (with protein)
  - 198
  - same as others


---

## Test dataset 

- randstr
   - 81 native PDB: 500 decoys each
   - decoys: close -> distance, gradient

- farna
   - 20 native PDB: 500 near-native decoys each


- farfar
   - 25 native RNA motifs: 4~48 near-native decoys
   - Generated by Rosetta protocol

---

## Scores

- Scores compared:  
     - **3drnascore**: distance term + torsion angle term   
     - **rasp**: trained on the 85 native structures in decoyset 1  
     - **dfire_c**: dfire_rna trained on RNAs from complex structures (198)  
     - **dfire_v**: dfire_rna trained on RNAs from RNA-only structures (55)  
     - **rosetta**: rosetta rna_score
     
---

## decoy test

```{r fig.height=6,fig.align='center', echo=FALSE, warning=FALSE}
load("~/GIT/dfire_rna/dataset/decoy_test/gg_decoy.rda")

print(gg_decoy)
```


---

## near native test (COR)

```{r fig.height=6,fig.align='center', echo=FALSE, warning=FALSE}
load(file="~/GIT/dfire_rna//dataset/decoy_test/tmp.rda")

print(gg2)
```

---

## near native test (ES)

```{r fig.height=6,fig.align='center', echo=FALSE, warning=FALSE}
load(file="~/GIT/dfire_rna//dataset/decoy_test/gg1.rda")

print(gg)
```


---

## DFIRE complex / RNA-only

- complex structures: 198 vs RNA-only: 55
- Pearson correlation coefficient seems to

```{r fig.height=6,fig.align='center', echo=FALSE}
load("~/GIT/dfire_rna/dataset/decoy_test/gg_dfire.rda")

print(gg_dfire)
```



---

## Ongoing

- Implementing torsion angle term
